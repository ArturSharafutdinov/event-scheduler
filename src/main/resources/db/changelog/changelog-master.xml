<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">
    
    <changeSet id="09.1333" author="asharafutdinov">
        <createTable tableName="GENRE">
            <column name="GENRE_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="COMPANY">
            <column name="COMPANY_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="BIRTHDAY" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="GAME">
            <column name="GAME_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PRICE" type="double">
                <constraints nullable="false"/>
            </column>
            <column name="GENRE_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_game_genre_id" references="GENRE(GENRE_ID)"/>
            </column>
            <column name="COMPANY_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_game_company_id" references="COMPANY(COMPANY_ID)"/>
            </column>
        </createTable>

        <createTable tableName="PLATFORM">
            <column name="PLATFORM_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="SERVICE">
            <column name="SERVICE_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="USERS" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="PLATFORM_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_service_platform_id" references="PLATFORM(PLATFORM_ID)"/>
            </column>
        </createTable>

        <createTable tableName="BILL">
            <column name="BILL_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="BILL_DATE" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="SALE">
            <column name="SALE_ID" type="bigint" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="SERVICE_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_sale_service_id" references="SERVICE(SERVICE_ID)"/>
            </column>
            <column name="GAME_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_sale_game_id" references="GAME(GAME_ID)"/>
            </column>
            <column name="BILL_ID" type="bigint">
                <constraints nullable="false" foreignKeyName="fk_sale_bill_id" references="BILL(BILL_ID)"/>
            </column>
            <column name="PRICE" type="double">
                <constraints nullable="false"/>
            </column>
            <column name="COUNT" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
    </changeSet>

</databaseChangeLog>